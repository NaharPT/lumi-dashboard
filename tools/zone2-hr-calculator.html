<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Zone 2 HR Calculator - Endurance Training</title>
    <style>
        :root {
            --bg: #0f172a;
            --surface: #1e293b;
            --surface2: #334155;
            --border: #475569;
            --text: #e2e8f0;
            --text-muted: #94a3b8;
            --accent: #38bdf8;
            --danger: #f87171;
            --warn: #fbbf24;
            --ok: #4ade80;

            --zone1: #4ade80;
            --zone2: #38bdf8;
            --zone3: #fbbf24;
            --zone4: #fb923c;
            --zone5: #f87171;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background-color: var(--bg);
            color: var(--text);
            line-height: 1.6;
            padding: 2rem 1rem;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            margin-bottom: 2rem;
        }

        h1 {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
            color: var(--accent);
        }

        .subtitle {
            font-size: 1.125rem;
            color: var(--text-muted);
        }

        .card {
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: 0.75rem;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
        }

        .card h2 {
            font-size: 1.5rem;
            margin-bottom: 1rem;
            color: var(--text);
        }

        .card h3 {
            font-size: 1.25rem;
            margin-bottom: 0.75rem;
            color: var(--text);
        }

        .input-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .input-group {
            display: flex;
            flex-direction: column;
        }

        label {
            font-size: 0.875rem;
            font-weight: 500;
            margin-bottom: 0.5rem;
            color: var(--text-muted);
        }

        input[type="number"] {
            background: var(--surface2);
            border: 1px solid var(--border);
            border-radius: 0.5rem;
            padding: 0.75rem;
            font-size: 1rem;
            color: var(--text);
            transition: border-color 0.2s;
        }

        input[type="number"]:focus {
            outline: none;
            border-color: var(--accent);
        }

        .checkbox-group {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-top: 0.5rem;
        }

        input[type="checkbox"] {
            width: 1.125rem;
            height: 1.125rem;
            cursor: pointer;
        }

        .checkbox-group label {
            margin: 0;
            cursor: pointer;
            font-size: 0.875rem;
        }

        button {
            background: var(--accent);
            color: var(--bg);
            border: none;
            border-radius: 0.5rem;
            padding: 0.75rem 1.5rem;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: opacity 0.2s;
        }

        button:hover {
            opacity: 0.9;
        }

        button:active {
            transform: scale(0.98);
        }

        .zone2-display {
            background: linear-gradient(135deg, var(--surface2) 0%, var(--surface) 100%);
            border: 2px solid var(--zone2);
            border-radius: 0.75rem;
            padding: 2rem;
            text-align: center;
            margin-bottom: 1.5rem;
        }

        .zone2-display h3 {
            font-size: 1.125rem;
            color: var(--text-muted);
            margin-bottom: 1rem;
        }

        .zone2-range {
            font-size: 3rem;
            font-weight: 700;
            color: var(--zone2);
            margin-bottom: 0.5rem;
        }

        .zone2-subtext {
            font-size: 1rem;
            color: var(--text-muted);
        }

        .talk-test {
            background: var(--surface2);
            border-left: 4px solid var(--ok);
            padding: 1rem;
            margin-top: 1rem;
            border-radius: 0.5rem;
        }

        .talk-test p {
            font-size: 0.95rem;
            color: var(--text-muted);
        }

        .formulas-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1rem;
            margin-top: 1rem;
        }

        .formula-card {
            background: var(--surface2);
            border: 1px solid var(--border);
            border-radius: 0.75rem;
            padding: 1.25rem;
        }

        .formula-card h4 {
            font-size: 1.125rem;
            margin-bottom: 0.75rem;
            color: var(--accent);
        }

        .formula-card .formula-desc {
            font-size: 0.875rem;
            color: var(--text-muted);
            margin-bottom: 1rem;
        }

        .formula-result {
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--text);
        }

        .zones-chart {
            margin-top: 1.5rem;
        }

        .zone-bar {
            display: flex;
            align-items: center;
            margin-bottom: 0.75rem;
            gap: 1rem;
        }

        .zone-label {
            width: 80px;
            font-size: 0.875rem;
            font-weight: 600;
        }

        .zone-bar-container {
            flex: 1;
            height: 40px;
            background: var(--surface2);
            border-radius: 0.5rem;
            overflow: hidden;
            position: relative;
        }

        .zone-bar-fill {
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.875rem;
            font-weight: 600;
            color: var(--bg);
            transition: width 0.3s;
        }

        .zone1 { background: var(--zone1); }
        .zone2 { background: var(--zone2); }
        .zone3 { background: var(--zone3); }
        .zone4 { background: var(--zone4); }
        .zone5 { background: var(--zone5); }

        .zone-bar.highlighted {
            transform: scale(1.05);
        }

        .zone-bar.highlighted .zone-bar-container {
            border: 2px solid var(--accent);
            box-shadow: 0 0 20px rgba(56, 189, 248, 0.3);
        }

        .reference-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1rem;
        }

        .reference-item {
            background: var(--surface2);
            border-radius: 0.5rem;
            padding: 1rem;
        }

        .reference-item h4 {
            font-size: 1rem;
            margin-bottom: 0.5rem;
            color: var(--accent);
        }

        .reference-item p, .reference-item ul {
            font-size: 0.875rem;
            color: var(--text-muted);
        }

        .reference-item ul {
            list-style-position: inside;
            margin-top: 0.5rem;
        }

        .reference-item li {
            margin-bottom: 0.25rem;
        }

        .maffetone-adjustments {
            margin-top: 1rem;
            padding: 1rem;
            background: var(--surface);
            border-radius: 0.5rem;
        }

        .maffetone-adjustments p {
            font-size: 0.875rem;
            color: var(--text-muted);
            margin-bottom: 0.75rem;
        }

        .adjustment-options {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        @media (max-width: 768px) {
            h1 {
                font-size: 2rem;
            }

            .zone2-range {
                font-size: 2.25rem;
            }

            .input-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Zone 2 HR Calculator</h1>
            <p class="subtitle">Endurance Training Heart Rate Zones</p>
        </header>

        <div class="card">
            <h2>Your Profile</h2>
            <div class="input-grid">
                <div class="input-group">
                    <label for="age">Age (years) *</label>
                    <input type="number" id="age" min="18" max="100" placeholder="e.g., 35">
                </div>
                <div class="input-group">
                    <label for="restingHR">Resting Heart Rate (bpm)</label>
                    <input type="number" id="restingHR" min="30" max="100" placeholder="Optional (e.g., 60)">
                </div>
                <div class="input-group">
                    <label for="maxHR">Max Heart Rate (bpm)</label>
                    <input type="number" id="maxHR" min="100" max="220" placeholder="Optional (auto-calculated)">
                </div>
            </div>
            <button onclick="calculateZones()">Calculate Zones</button>
            <button onclick="saveProfile()" style="background: var(--surface2); color: var(--text); margin-left: 0.5rem;">Save Profile</button>
        </div>

        <div id="results" style="display: none;">
            <div class="zone2-display">
                <h3>Your Zone 2 Training Range</h3>
                <div class="zone2-range" id="zone2Range">-- - -- bpm</div>
                <p class="zone2-subtext">Endurance base building intensity</p>
                <div class="talk-test">
                    <p><strong>Talk Test:</strong> You should be able to hold a conversation comfortably, speaking in full sentences without gasping for air.</p>
                </div>
            </div>

            <div class="card">
                <h2>Calculation Methods</h2>
                <div class="formulas-grid">
                    <div class="formula-card">
                        <h4>Maffetone Method</h4>
                        <p class="formula-desc">180 - age with fitness adjustments</p>
                        <div class="formula-result" id="maffetoneResult">-- bpm</div>
                        <div class="maffetone-adjustments">
                            <p>Adjust for your fitness level:</p>
                            <div class="adjustment-options">
                                <div class="checkbox-group">
                                    <input type="checkbox" id="recovering" onchange="calculateZones()">
                                    <label for="recovering">Recovering from illness/injury (-10)</label>
                                </div>
                                <div class="checkbox-group">
                                    <input type="checkbox" id="beginner" onchange="calculateZones()">
                                    <label for="beginner">New to training (-5)</label>
                                </div>
                                <div class="checkbox-group">
                                    <input type="checkbox" id="experienced" onchange="calculateZones()">
                                    <label for="experienced">Training 2+ years consistently (+5)</label>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="formula-card">
                        <h4>Karvonen (HRR)</h4>
                        <p class="formula-desc">60-70% of Heart Rate Reserve</p>
                        <div class="formula-result" id="karvonenResult">-- - -- bpm</div>
                        <p style="font-size: 0.75rem; color: var(--text-muted); margin-top: 0.5rem;">
                            <em>Requires resting HR for accuracy</em>
                        </p>
                    </div>

                    <div class="formula-card">
                        <h4>% Max HR</h4>
                        <p class="formula-desc">60-70% of maximum heart rate</p>
                        <div class="formula-result" id="percentMaxResult">-- - -- bpm</div>
                        <p style="font-size: 0.75rem; color: var(--text-muted); margin-top: 0.5rem;">
                            <em>Max HR: <span id="maxHRDisplay">--</span> bpm</em>
                        </p>
                    </div>
                </div>
            </div>

            <div class="card">
                <h2>All Heart Rate Zones</h2>
                <div class="zones-chart" id="zonesChart"></div>
            </div>

            <div class="card">
                <h2>Zone 2 Quick Reference</h2>
                <div class="reference-grid">
                    <div class="reference-item">
                        <h4>What It Feels Like</h4>
                        <ul>
                            <li>Comfortable, conversational pace</li>
                            <li>You can breathe through your nose</li>
                            <li>Feels "too easy" if you're new to it</li>
                            <li>Sustainable for hours</li>
                        </ul>
                    </div>
                    <div class="reference-item">
                        <h4>Physiological Benefits</h4>
                        <ul>
                            <li>Builds mitochondrial density</li>
                            <li>Improves fat oxidation</li>
                            <li>Enhances cardiovascular efficiency</li>
                            <li>Increases capillary density</li>
                            <li>Low injury risk</li>
                        </ul>
                    </div>
                    <div class="reference-item">
                        <h4>Recommended Volume</h4>
                        <ul>
                            <li>3-5 sessions per week</li>
                            <li>45-90 minutes per session</li>
                            <li>80% of total training time for endurance athletes</li>
                            <li>Build gradually over months</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Load saved profile on page load
        window.addEventListener('DOMContentLoaded', () => {
            loadProfile();
        });

        function loadProfile() {
            const saved = localStorage.getItem('zone2Profile');
            if (saved) {
                const profile = JSON.parse(saved);
                document.getElementById('age').value = profile.age || '';
                document.getElementById('restingHR').value = profile.restingHR || '';
                document.getElementById('maxHR').value = profile.maxHR || '';

                if (profile.age) {
                    calculateZones();
                }
            }
        }

        function saveProfile() {
            const profile = {
                age: document.getElementById('age').value,
                restingHR: document.getElementById('restingHR').value,
                maxHR: document.getElementById('maxHR').value
            };
            localStorage.setItem('zone2Profile', JSON.stringify(profile));
            alert('Profile saved successfully!');
        }

        function calculateZones() {
            const age = parseInt(document.getElementById('age').value);
            const restingHRInput = document.getElementById('restingHR').value;
            const maxHRInput = document.getElementById('maxHR').value;

            if (!age || age < 18 || age > 100) {
                alert('Please enter a valid age (18-100)');
                return;
            }

            const restingHR = restingHRInput ? parseInt(restingHRInput) : 60;
            const maxHR = maxHRInput ? parseInt(maxHRInput) : (220 - age);

            // Maffetone calculation
            let maffetone = 180 - age;
            if (document.getElementById('recovering').checked) maffetone -= 10;
            if (document.getElementById('beginner').checked) maffetone -= 5;
            if (document.getElementById('experienced').checked) maffetone += 5;

            // Karvonen calculation (60-70% of HRR)
            const hrr = maxHR - restingHR;
            const karvonenLow = Math.round(restingHR + (hrr * 0.60));
            const karvonenHigh = Math.round(restingHR + (hrr * 0.70));

            // % Max HR (60-70%)
            const percentMaxLow = Math.round(maxHR * 0.60);
            const percentMaxHigh = Math.round(maxHR * 0.70);

            // Average Zone 2 range (using Karvonen as primary)
            const zone2Low = karvonenLow;
            const zone2High = karvonenHigh;

            // Update displays
            document.getElementById('zone2Range').textContent = `${zone2Low} - ${zone2High} bpm`;
            document.getElementById('maffetoneResult').textContent = `${maffetone} bpm`;
            document.getElementById('karvonenResult').textContent = `${karvonenLow} - ${karvonenHigh} bpm`;
            document.getElementById('percentMaxResult').textContent = `${percentMaxLow} - ${percentMaxHigh} bpm`;
            document.getElementById('maxHRDisplay').textContent = maxHR;

            // Calculate all zones
            const zones = [
                { name: 'Zone 1', desc: 'Recovery', low: Math.round(maxHR * 0.50), high: Math.round(maxHR * 0.60), class: 'zone1' },
                { name: 'Zone 2', desc: 'Endurance', low: zone2Low, high: zone2High, class: 'zone2' },
                { name: 'Zone 3', desc: 'Tempo', low: Math.round(maxHR * 0.70), high: Math.round(maxHR * 0.80), class: 'zone3' },
                { name: 'Zone 4', desc: 'Threshold', low: Math.round(maxHR * 0.80), high: Math.round(maxHR * 0.90), class: 'zone4' },
                { name: 'Zone 5', desc: 'Max', low: Math.round(maxHR * 0.90), high: maxHR, class: 'zone5' }
            ];

            renderZonesChart(zones, maxHR);

            document.getElementById('results').style.display = 'block';
        }

        function renderZonesChart(zones, maxHR) {
            const chart = document.getElementById('zonesChart');
            chart.innerHTML = '';

            zones.forEach((zone, index) => {
                const range = zone.high - zone.low;
                const width = (range / maxHR) * 100;

                const bar = document.createElement('div');
                bar.className = `zone-bar ${index === 1 ? 'highlighted' : ''}`;

                bar.innerHTML = `
                    <div class="zone-label">${zone.name}</div>
                    <div class="zone-bar-container">
                        <div class="zone-bar-fill ${zone.class}" style="width: ${width}%">
                            ${zone.low} - ${zone.high} bpm
                        </div>
                    </div>
                    <div style="width: 100px; font-size: 0.875rem; color: var(--text-muted);">${zone.desc}</div>
                `;

                chart.appendChild(bar);
            });
        }
    </script>
</body>
</html>
